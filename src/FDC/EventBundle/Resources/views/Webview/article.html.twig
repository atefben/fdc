{% trans_default_domain 'FDCEventBundle' %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Festival de Canne - Page plan</title>
    <link type="text/css" rel="stylesheet" href="http://fast.fonts.net/cssapi/47cc6bed-5912-4140-bc5c-4caa2425b61d.css"/>
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i|Playfair+Display:400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="{{ asset('bundles/fdcevent/webview/css/webview.css') }}" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  </head>
  <body class="Article">
    <article class="Article-wrapper">
      <header class="Article-header">
        {% if (object.video != null or object.image != null or object.header != null) %}
        {% if object.image != null %}
          {% set cover_image = object.image|trans_fallback('file') %}
        {% elseif object.imageAmazonUrl != null %}
          {% set cover_image = s3_server_video ~ object|trans_fallback('imageAmazonUrl') %}
        {% else %}
          {% set trans = object.findTranslationByLocale(app.request.locale) %}
          {% set cover_image = trans.translatable.header|trans_fallback('file') %}
        {% endif %}

        {% set header = object.header %}
          {% if header is not null %}
              {% set imageTrans = object.header.findTranslationByLocale(app.request.locale) %}
              {% if imageTrans is null or imageTrans.file is null %}
                  {% set imageTrans = object.header.findTranslationByLocale('fr') %}
              {% endif %}
          {% endif %}
          {% if object.video is not null %}
            {% if object.video.image is not null %}
                {% if imageTrans is defined %}
                    {% set cover_image = imageTrans.file %}
                {% else %}
                    {% set header = object.video.image %}
                    {% set imageTrans = header.findTranslationByLocale(app.request.locale) %}
                    {% if imageTrans is null or imageTrans.file is null %}
                        {% set imageTrans = header.findTranslationByLocale('fr') %}
                    {% endif %}

                    {% set cover_image = imageTrans.file %}
                {% endif %}
            {% endif %}
          {% endif %}
        {% if object.video is not null %}
        <a href="#" class="Article-video-play"><img src="{{ asset('bundles/fdcevent/img/article/Article-video-play.png') }}"/></a>
        {% endif %}
        <video preload="none" style="background-image: url({% path cover_image , 'reference' %})">
          <source src="{{ s3_server_video ~ object.video|trans_fallback('mp4Url') }}" type="video/mp4"/>
        </video>
        {% elseif object is news_image %}
          <div class="Article-slider-wrapper">
            <a class="Article-slider-prev" href="#"></a>
            <a class="Article-slider-next" href="#"></a>
            <div class="Article-slider">
              {% for key, gallery in object.gallery.medias %}
              <div class="Article-slider-item">
                <img src="{% path gallery.media|trans_fallback('file'), '640x400' %}"/>
                <span class="Article-slider-caption"><strong>{{ gallery.media|trans_fallback('legend')}}</strong> {{ gallery.media|trans_fallback('copyright') }}</span> 
              </div>
              {% endfor %}
            </div>
            <div class="Article-slider-count"><strong>1</strong>/{{ object.gallery.medias|length }}</div>
          </div>
        {% endif %}
        <div class="Article-header-meta">
          <span class="Article-header-meta-category">{{ object.theme|trans_fallback('name') }}</span>
          <span class="Article-header-meta-date"><strong>{{ object.publishedAt|date('d/m/y') }}</strong> {{ agenda_leftbar_translate_hour(object.publishedAt|date('H:i'), true, true) }}</span>
          <span class="Article-header-meta-misc"><strong>Le jury 2016</strong> © FDC / Théophile Delange</span>
        </div>
      </header>
      <div class="Article-content">
        <h1>{{ object|trans_fallback('title') }}</h1>

        <strong>{{ object|trans_fallback('introduction')|raw }}</strong>

        {% for widget in object.widgets %}
            {% if widget is news_widget_image and widget.gallery.medias is defined and widget.gallery.medias|length == 1 %}
                {% include 'FDCEventBundle:Webview:widget/single-photo.html.twig' with ({
                'photo' : widget.gallery.medias[0].media,
                'photo_class' : ' large-photo'
                }) %}
            {% elseif widget is news_widget_image and widget.gallery.medias is defined and widget.gallery.medias|length > 1 %}
                {% include 'FDCEventBundle:Webview:widget/slideshow.html.twig' %}
            {% elseif widget is news_widget_text %}
                {% include 'FDCEventBundle:Webview:widget/text.html.twig' %}
            {% elseif widget is news_widget_video %}
                {% if is_available_video(widget.file) %}
                    {% include 'FDCEventBundle:Webview:widget/video.html.twig' with {'widget': widget} %}
                {% endif %}
            {% elseif widget is news_widget_video_youtube %}
                {% include 'FDCEventBundle:Webview:widget/video-youtube.html.twig' with {'widget': widget} %}
            {% elseif widget is news_widget_audio %}
                {% if widget.title is defined %}
                    <h2 class="title">{{ widget.title }}</h2>
                {% endif %}
                {% include 'FDCEventBundle:Webview:widget/audio.html.twig' with {'widget': widget} %}
            {% elseif widget is news_widget_quote %}
                {% include 'FDCEventBundle:Webview:widget/quote.html.twig' %}
            {% elseif widget is news_widget_image_dual_align %}
                {% include 'FDCEventBundle:Webview:widget/dual-photo.html.twig' %}
            {% endif %}
        {% endfor %}
        <span style="font-size:0.8rem" >{{ 'webview.article.signature_prefix'|trans }} {{ object.signature }}</span>
      </div>
      <!--div class="Article-push">
        <div class="Article-push-image">
          <img src="{{ asset('bundles/fdcevent/img/article/push-cover.png') }}" class="Article-push-cover"/>
        </div><div class="Article-push-content">
          <strong>Cinéma de la plage</strong>
          <h3>Plus fort que les bombes</h3>
          <span>Eric Hannezo</span>
          <p>France - 2014<br/>
          1h35</p>
        </div>
      </div-->
    </article>
    {% if sameDayObjects != null %}
    <aside class="Article-related">
      <h2>Le même jour</h2>
      <div class="Article-related-slider-wrapper">
        <div class="Article-related-slider">
        {% for associatedNews in sameDayObjects %}
          {% set type = 'news' %}
          {% set variant = 'article' %}
          {% if associatedNews is news_article %}
            {% set type = 'news' %}
            {% set variant = 'article' %}
          {% elseif associatedNews is news_video %}
            {% set type = 'news' %}
            {% set variant = 'video' %}
          {% elseif associatedNews is news_audio %}
            {% set type = 'news' %}
            {% set variant = 'audio' %}
          {% elseif associatedNews is news_image %}
            {% set type = 'news' %}
            {% set variant = 'image' %} 
          {% endif %}
          {%  set iconClass = 'icon-article' %}
          {%  if class(associatedNews) ends with 'Article'  %}
            {%  set iconClass = 'icon-article' %}
          {% endif %}
          {%  if class(associatedNews) ends with 'Image'  %}
            {%  set iconClass = 'icon-photo' %}
          {% endif %}
          <a href="{{ path('fdc_event_webview_article' , {'type': type, 'variant': variant, 'id':associatedNews.id }) }}" class="Article-related-slider-item">
            <div class="Article-related-slider-item-pictureWrap">
            {% if associatedNews.header is not null %}
              {% if associatedNews.header.file is null %}
                <img src="{{ asset('bundles/fdcevent/img/article/placeholder.png') }}"/>
              {% else %}
                <img src="{% path associatedNews.header|trans_fallback('file'), 'reference' %}"/>
              {% endif %}
            {% endif %}
              <i class="Article-related-slider-icon {{ iconClass }}"></i>
            </div>
            <div class="Article-related-slider-caption">
              <h4>{{ associatedNews.theme|trans_fallback('name') }}</h4> <p>18.05.15&nbsp;&nbsp;.&nbsp;&nbsp;09:00</p>
              <strong>{{ associatedNews|trans_fallback('title') }}</strong>
            </div>
          </a>
          {% endfor %}
      </div>
    </aside>
    {% endif %}
    <script type="text/javascript" src="{{ asset('bundles/fdcevent/webview/js/vendors/jquery-3.1.1.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/fdcevent/webview/js/vendors/sly.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/fdcevent/webview/js/vendors/jwplayer.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/fdcevent/webview/js/article.js') }}"></script>
    <script>jwplayer.key="DDlGCb2Z6Hc44IZsRCireCJGh+dhUmBcgQzM1Q==";</script>
  </body>
</html>
 